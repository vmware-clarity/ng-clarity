<!--
~ Copyright (c) 2016-2025 Broadcom. All Rights Reserved.
~ The term "Broadcom" refers to Broadcom Inc. and/or its subsidiaries.
~ This software is released under MIT license.
~ The full license information can be found in LICENSE in the root directory of this project.
-->

<h2>Selection (Single)</h2>

<p>
  Depending on the use case, you might want to restrict the user to only allow single selection in a datagrid. If you
  haven't done so, please read the previous section on general selection first.
</p>
<ul>
  <li>
    For single select, instead of
    <code class="clr-code">[(clrDgSelected)]</code>, add a <code class="clr-code">[(clrDgSingleSelected)]</code> two-way
    binding on the datagrid itself, to have access to the currently selected item. Note that by setting this value
    yourself, you can dynamically select an element if you need to.
  </li>
</ul>

<p>
  In the following example, we simply display the name of the selected user, but since we have access to the full
  objects, we could perform any operation we want on it.
</p>

<p>
  User should be able to dynamically change selection trough datagrid input
  <code class="clr-code">[(clrDgSingleSelected)]</code>.
  <button class="btn" (click)="selectItems()">Select items</button>
</p>

<h3>Client side, no trackBy</h3>

<div class="card card-block">
  <div class="card-text username-list">
    Selected user: @if (!singleSelected) {
    <em>No user selected.</em>
    } @if (singleSelected) {
    <span class="username">{{singleSelected.name}}</span>
    <div class="username">Value: {{singleSelected | json }}</div>
    }
  </div>
</div>

<clr-datagrid [(clrDgSingleSelected)]="singleSelected" [clrDgItemsIdentityFn]="idendityFn">
  <clr-dg-column>User ID</clr-dg-column>
  <clr-dg-column>Name</clr-dg-column>
  <clr-dg-column>Creation date</clr-dg-column>
  <clr-dg-column>Favorite color</clr-dg-column>

  <clr-dg-row
    *clrDgItems="let user of users"
    [clrDgItem]="user"
    [clrDgRowSelectionLabel]="'Select row for ' + user.name"
  >
    <clr-dg-cell>{{user.id}}</clr-dg-cell>
    <clr-dg-cell>{{user.name}}</clr-dg-cell>
    <clr-dg-cell>{{user.creation | date}}</clr-dg-cell>
    <clr-dg-cell>
      <span class="color-square" [style.backgroundColor]="user.color"></span>
    </clr-dg-cell>
  </clr-dg-row>

  <clr-dg-footer>
    {{users.length}} users
    <clr-dg-pagination></clr-dg-pagination>
  </clr-dg-footer>
</clr-datagrid>

<h3>Client side, trackBy index</h3>

<div class="card card-block">
  <div class="card-text username-list">
    Selected user: @if (!trackByIndexSingleSelected) {
    <em>No user selected.</em>
    } @if (trackByIndexSingleSelected) {
    <span class="username">{{trackByIndexSingleSelected.name}}</span>
    <div class="username">Value: {{trackByIndexSingleSelected | json }}</div>
    }
  </div>
</div>

<clr-datagrid [(clrDgSingleSelected)]="trackByIndexSingleSelected" [clrDgItemsIdentityFn]="idendityFn">
  <clr-dg-column>User ID</clr-dg-column>
  <clr-dg-column>Name</clr-dg-column>
  <clr-dg-column>Creation date</clr-dg-column>
  <clr-dg-column>Favorite color</clr-dg-column>

  <clr-dg-row
    *clrDgItems="let user of trackByIndexUsers; trackBy: trackByIndex"
    [clrDgItem]="user"
    [clrDgRowSelectionLabel]="'Select row for ' + user.name"
  >
    <clr-dg-cell>{{user.id}}</clr-dg-cell>
    <clr-dg-cell>{{user.name}}</clr-dg-cell>
    <clr-dg-cell>{{user.creation | date}}</clr-dg-cell>
    <clr-dg-cell>
      <span class="color-square" [style.backgroundColor]="user.color"></span>
    </clr-dg-cell>
  </clr-dg-row>

  <clr-dg-footer>
    {{users.length}} users
    <clr-dg-pagination></clr-dg-pagination>
  </clr-dg-footer>
</clr-datagrid>

<h3>Client side, trackBy item</h3>

<div class="card card-block">
  <div class="card-text username-list">
    Selected user: @if (!trackByIdSingleSelected) {
    <em>No user selected.</em>
    } @if (trackByIdSingleSelected) {
    <span class="username">{{trackByIdSingleSelected.name}}</span>
    <div class="username">Value: {{trackByIdSingleSelected | json }}</div>
    }
  </div>
</div>

<clr-datagrid [(clrDgSingleSelected)]="trackByIdSingleSelected" [clrDgItemsIdentityFn]="idendityFn">
  <clr-dg-column>User ID</clr-dg-column>
  <clr-dg-column>Name</clr-dg-column>
  <clr-dg-column>Creation date</clr-dg-column>
  <clr-dg-column>Favorite color</clr-dg-column>

  <clr-dg-row
    *clrDgItems="let user of trackByIdUsers; trackBy: trackById"
    [clrDgItem]="user"
    [clrDgRowSelectionLabel]="'Select row for ' + user.name"
  >
    <clr-dg-cell>{{user.id}}</clr-dg-cell>
    <clr-dg-cell>{{user.name}}</clr-dg-cell>
    <clr-dg-cell>{{user.creation | date}}</clr-dg-cell>
    <clr-dg-cell>
      <span class="color-square" [style.backgroundColor]="user.color"></span>
    </clr-dg-cell>
  </clr-dg-row>

  <clr-dg-footer>
    {{users.length}} users
    <clr-dg-pagination></clr-dg-pagination>
  </clr-dg-footer>
</clr-datagrid>

<h3>Server-driven, trackBy item</h3>

<div class="card card-block">
  <div class="card-text username-list">
    Selected user: @if (!trackByIdServerSingleSelected) {
    <em>No user selected.</em>
    } @if (trackByIdServerSingleSelected) {
    <span class="username">{{trackByIdServerSingleSelected.id}}</span>
    <div class="username">Value: {{trackByIdServerSingleSelected | json }}</div>
    }
  </div>
</div>

<clr-datagrid
  (clrDgRefresh)="refresh($event)"
  [(clrDgSingleSelected)]="trackByIdServerSingleSelected"
  [clrDgLoading]="loading"
  [clrDgItemsIdentityFn]="idendityFn"
>
  <clr-dg-column>User ID</clr-dg-column>
  <clr-dg-column>Name</clr-dg-column>
  <clr-dg-column>Creation date</clr-dg-column>
  <clr-dg-column>Favorite color</clr-dg-column>

  @for (user of trackByIdServerUsers; track trackById($index, user)) {
  <clr-dg-row [clrDgItem]="user" [clrDgRowSelectionLabel]="'Select row for ' + user.name">
    <clr-dg-cell>{{user.id}}</clr-dg-cell>
    <clr-dg-cell>{{user.name}}</clr-dg-cell>
    <clr-dg-cell>{{user.creation | date}}</clr-dg-cell>
    <clr-dg-cell>
      <span class="color-square" [style.backgroundColor]="user.color"></span>
    </clr-dg-cell>
  </clr-dg-row>
  }

  <clr-dg-footer>
    <clr-dg-pagination #pagination [clrDgTotalItems]="total"></clr-dg-pagination>
    {{pagination.firstItem + 1}} - {{pagination.lastItem + 1}} of {{total}} users
  </clr-dg-footer>
</clr-datagrid>
