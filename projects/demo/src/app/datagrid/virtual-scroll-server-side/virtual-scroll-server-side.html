<!--
  ~ Copyright (c) 2016-2023 VMware, Inc. All Rights Reserved.
  ~ This software is released under MIT license.
  ~ The full license information can be found in LICENSE in the root directory of this project.
-->

<h2>Virtual scroll server side</h2>
<div>
  <clr-input-container>
    <label>Rows</label>
    <input clrInput id="rows" type="number" name="rows" [(ngModel)]="currentPageSize" />
  </clr-input-container>
  <button class="btn" (click)="refreshPage()">Recalculate Datagrid</button>
  <div>Current Page Size: {{currentPageSize}}</div>
</div>

<clr-datagrid
  *ngIf="{ users: users | async }; let data"
  [clrDgLoading]="loading"
  [clrLoadingMoreItems]="loadingMoreItems"
  style="height: 30rem"
>
  <clr-dg-column>
    <ng-container>User ID</ng-container>
  </clr-dg-column>
  <clr-dg-column>
    <!--Name-->
    <ng-container>Name</ng-container>
  </clr-dg-column>
  <clr-dg-column>
    <ng-container>Creation date</ng-container>
  </clr-dg-column>
  <clr-dg-column>
    <ng-container>Pokemon</ng-container>
  </clr-dg-column>
  <clr-dg-column>
    <ng-container>Favorite color</ng-container>
  </clr-dg-column>

  <ng-template
    *ngIf="data.users"
    customClrVirtualRows
    let-user
    [customClrVirtualRowsOf]="data.users"
    [customClrVirtualRowsItemSize]="32"
    [customClrVirtualRowsMinBufferPx]="100"
    [customClrVirtualRowsMaxBufferPx]="200"
    [customClrVirtualRowsKeyboardScrollPageSize]="32"
    [customClrVirtualRowsTemplateCacheSize]="100"
    (renderedRangeChange)="renderRangeChange($event)"
  >
    <clr-dg-row [clrDgItem]="user">
      <clr-dg-cell>{{user.id}}</clr-dg-cell>
      <clr-dg-cell>{{user.name}}</clr-dg-cell>
      <clr-dg-cell>{{user.creation | date}}</clr-dg-cell>
      <clr-dg-cell> {{user.pokemon.name}} </clr-dg-cell>
      <clr-dg-cell>
        <span class="color-square" [style.backgroundColor]="user.color"></span>
      </clr-dg-cell>
    </clr-dg-row>
  </ng-template>

  <clr-dg-footer> {{data.users?.length}} </clr-dg-footer>
</clr-datagrid>
